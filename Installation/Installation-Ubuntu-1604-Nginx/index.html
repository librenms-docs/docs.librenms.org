<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="LibreNMS">
    <link rel="canonical" href="http://docs.librenms.org/Installation/Installation-Ubuntu-1604-Nginx/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Ubuntu 16.04 (Nginx) - LibreNMS Docs</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../librenms.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "DB Server", url: "#db-server", children: [
              {title: "Install / Configure MySQL", url: "#install-configure-mysql" },
          ]},
          {title: "Web Server", url: "#web-server", children: [
              {title: "Install / Configure Nginx", url: "#install-configure-nginx" },
              {title: "Add librenms user", url: "#add-librenms-user" },
              {title: "Clone repo", url: "#clone-repo" },
              {title: "Web interface", url: "#web-interface" },
              {title: "Web installer", url: "#web-installer" },
              {title: "Configure snmpd", url: "#configure-snmpd" },
              {title: "Cron job", url: "#cron-job" },
              {title: "Copy logrotate config", url: "#copy-logrotate-config" },
              {title: "Final steps", url: "#final-steps" },
              {title: "Add first device", url: "#add-first-device" },
              {title: "What next?", url: "#what-next" },
              {title: "Closing", url: "#closing" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-79149977-2', 'docs.librenms.org');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    


    
      <div class="source-links">
      
          <span class="label label-primary"><a href="https://github.com/librenms/librenms/edit/master/doc/Installation/Installation-Ubuntu-1604-Nginx.md" target="_blank" style="color:#ffffff"><i class="fa fa-pencil"></i> Edit on GitHub</a></span>
      
      </div>
    

    <blockquote>
<p>NOTE: These instructions assume you are the root user.  If you are not, prepend <code>sudo</code> to the shell commands (the ones that aren't at <code>mysql&gt;</code> prompts) or temporarily become a user with root privileges with <code>sudo -s</code> or <code>sudo -i</code>.</p>
</blockquote>
<h3 id="db-server">DB Server</h3>
<blockquote>
<p>NOTE: Whilst we are working on ensuring LibreNMS is compatible with MySQL strict mode, for now, please disable this after mysql is installed.</p>
</blockquote>
<h4 id="install-configure-mysql">Install / Configure MySQL</h4>
<pre><code class="bash">apt-get install mariadb-server mariadb-client
systemctl restart mysql
mysql -uroot -p
</code></pre>

<pre><code class="sql">CREATE DATABASE librenms CHARACTER SET utf8 COLLATE utf8_unicode_ci;
CREATE USER 'librenms'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON librenms.* TO 'librenms'@'localhost';
FLUSH PRIVILEGES;
exit
</code></pre>

<p><code>vim /etc/mysql/mariadb.conf.d/50-server.cnf</code></p>
<p>Within the [mysqld] section please add:</p>
<pre><code class="bash">innodb_file_per_table=1
sql-mode=&quot;&quot;
lower_case_table_names=0
</code></pre>

<p><code>systemctl restart mysql</code></p>
<h3 id="web-server">Web Server</h3>
<h4 id="install-configure-nginx">Install / Configure Nginx</h4>
<p><code>apt-get install php7.0-cli php7.0-mysql php7.0-gd php7.0-snmp php7.0-curl php7.0-fpm php7.0-xml snmp graphviz php7.0-mcrypt php7.0-json nginx-full fping imagemagick whois mtr-tiny nmap python-mysqldb snmpd rrdtool git</code></p>
<p>In <code>/etc/php/7.0/fpm/php.ini</code> and <code>/etc/php/7.0/cli/php.ini</code>, ensure date.timezone is set to your preferred time zone.  See http://php.net/manual/en/timezones.php for a list of supported timezones.  Valid examples are: "America/New_York", "Australia/Brisbane", "Etc/UTC".</p>
<pre><code class="bash">systemctl restart php7.0-fpm
phpenmod mcrypt
</code></pre>

<h4 id="add-librenms-user">Add librenms user</h4>
<pre><code class="bash">useradd librenms -d /opt/librenms -M -r
usermod -a -G librenms www-data
</code></pre>

<h4 id="clone-repo">Clone repo</h4>
<pre><code class="bash">cd /opt
git clone https://github.com/librenms/librenms.git librenms
</code></pre>

<h4 id="web-interface">Web interface</h4>
<pre><code class="bash">cd /opt/librenms
mkdir rrd logs
chmod 775 rrd
vim /etc/nginx/conf.d/librenms.conf
</code></pre>

<p>Add the following config:</p>
<pre><code class="nginx">server {
 listen      80;
 server_name librenms.example.com;
 root        /opt/librenms/html;
 index       index.php;
 access_log  /opt/librenms/logs/access_log;
 error_log   /opt/librenms/logs/error_log;
 charset utf-8;
 gzip on;
 gzip_types text/css application/javascript text/javascript application/x-javascript image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon;
 location / {
  try_files $uri $uri/ /index.php?$query_string;
 }
 location /api/v0 {
  try_files $uri $uri/ /api_v0.php?$query_string;
 }
 location ~ \.php {
  include fastcgi.conf;
  fastcgi_split_path_info ^(.+\.php)(/.+)$;
  fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;
 }
 location ~ /\.ht {
  deny all;
 }
}
</code></pre>

<pre><code class="bash">rm /etc/nginx/sites-enabled/default
systemctl restart nginx
</code></pre>

<h4 id="web-installer">Web installer</h4>
<p>Now head to: <code>http://librenms.example.com/install.php</code> and follow the on-screen instructions.</p>
<h4 id="configure-snmpd">Configure snmpd</h4>
<pre><code class="bash">cp /opt/librenms/snmpd.conf.example /etc/snmp/snmpd.conf
vim /etc/snmp/snmpd.conf
</code></pre>

<p>Edit the text which says <code>RANDOMSTRINGGOESHERE</code> and set your own community string.</p>
<pre><code class="bash">curl -o /usr/bin/distro https://raw.githubusercontent.com/librenms/librenms-agent/master/snmp/distro
chmod +x /usr/bin/distro
systemctl restart snmpd
</code></pre>

<h4 id="cron-job">Cron job</h4>
<p><code>cp librenms.nonroot.cron /etc/cron.d/librenms</code></p>
<h4 id="copy-logrotate-config">Copy logrotate config</h4>
<p>LibreNMS keeps logs in <code>/opt/librenms/logs</code>. Over time these can become large and be rotated out.  To rotate out the old logs you can use the provided logrotate config file:</p>
<pre><code>cp misc/librenms.logrotate /etc/logrotate.d/librenms
</code></pre>
<h4 id="final-steps">Final steps</h4>
<pre><code class="bash">chown -R librenms:librenms /opt/librenms
</code></pre>

<p>Run validate.php as root in the librenms directory:</p>
<pre><code class="bash">cd /opt/librenms
./validate.php
</code></pre>

<p>That's it!  You now should be able to log in to http://librenms.example.com/.  Please note that we have not covered HTTPS setup in this example, so your LibreNMS install is not secure by default.  Please do not expose it to the public Internet unless you have configured HTTPS and taken appropriate web server hardening steps.</p>
<h4 id="add-first-device">Add first device</h4>
<p>We now suggest that you add localhost as your first device from within the WebUI.</p>
<h4 id="what-next">What next?</h4>
<p>Now that you've installed LibreNMS, we'd suggest that you have a read of a few other docs to get you going:</p>
<ul>
<li><a href="http://docs.librenms.org/Support/Performance">Performance tuning</a></li>
<li><a href="http://docs.librenms.org/Extensions/Alerting/">Alerting</a></li>
<li><a href="http://docs.librenms.org/Extensions/Device-Groups/">Device Groups</a></li>
<li><a href="http://docs.librenms.org/Extensions/Auto-Discovery/">Auto discovery</a></li>
</ul>
<h4 id="closing">Closing</h4>
<p>We hope you enjoy using LibreNMS. If you do, it would be great if you would consider opting into the stats system we have, please see <a href="http://docs.librenms.org/General/Callback-Stats-and-Privacy/">this page</a> on what it is and how to enable it.</p>

  <br>
    


    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>