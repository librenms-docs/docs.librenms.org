<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="LibreNMS">
        <link rel="canonical" href="http://docs.librenms.org/Developing/os/Custom-Graphs/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	    <title>Custom Graphs - LibreNMS Docs</title>

        <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.6.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/color.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../librenms.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-79149977-2', 'docs.librenms.org');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">LibreNMS Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li id="dropdown-Installation" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Installation/Installing-LibreNMS/">Installing LibreNMS</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Ubuntu-image/">Ubuntu VM Image</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/CentOS-image/">CentOS VM Image</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-Ubuntu-1604-Nginx/">Ubuntu 16.04 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-Ubuntu-1604-Apache/">Ubuntu 16.04 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-CentOS-7-Nginx/">CentOS 7 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-CentOS-7-Apache/">CentOS 7 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installing-LibreNMS/">Older Docs</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Migrating-from-Observium/">Migrating from Observium</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-General" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">General <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../General/Acknowledgement/">Acknowledgement</a>
</li>

                        
                            
<li >
    <a href="../../../General/Callback-Stats-and-Privacy/">Callback Stats and Privacy</a>
</li>

                        
                            
<li >
    <a href="../../../General/Changelog/">Changelog</a>
</li>

                        
                            
<li >
    <a href="../../../General/Contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../../../General/Credits/">Credits</a>
</li>

                        
                            
<li >
    <a href="../../../General/Updating/">Updating</a>
</li>

                        
                            
<li >
    <a href="../../../General/Releases/">Releases</a>
</li>

                        
                            
<li >
    <a href="../../../General/Security/">Security</a>
</li>

                        
                            
<li >
    <a href="../../../General/Welcome-to-Observium-users/">Welcome to Observium users</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-Extensions" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Extensions <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Extensions/Alerting/">Alerting</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Applications/">Applications</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Authentication/">Authentication</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Auto-Discovery/">Auto Discovery</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Billing-Module/">Billing Module</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Component/">Component</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Dell-OpenManage/">Dell OpenManage</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Device-Groups/">Device Groups</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Distributed-Poller/">Distributed Poller</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Email-Alerting/">Email Alerting</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Globe-Frontpage/">Globe Frontpage</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Graylog/">Graylog</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Graphite/">Graphite</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/IRC-Bot/">IRC Bot</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/IRC-Bot-Extensions/">IRC Bot Extensions</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/InfluxDB/">InfluxDB</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Interface-Description-Parsing/">Interface Description Parsing</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/MIB-based-polling/">MIB based polling</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Memcached/">Memcached</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Network-Map/">Network Map</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/NFSen/">NFSen</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Oxidized/">Oxidized</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/PeeringDB/">PeeringDB</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Plugin-System/">Plugin System</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Poller-Service/">Poller Service</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Port-Description-Parser/">Port Description Parser</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Proxmox/">Proxmox</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/RRDCached/">RRDCached</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/RRDTune/">RRDTune</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/SNMP-Proxy/">SNMP Proxy</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/SNMP-Trap-Handler/">SNMP Trap Handler</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Services/">Services</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Smokeping/">Smokeping</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Sub-Directory/">Sub Directory</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Syslog/">Syslog</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Two-Factor-Auth/">Two Factor Auth</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Varnish/">Varnish</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-Developing" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developing <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Using-Git/">Using Git</a>
</li>

                        
                            
<li >
    <a href="../../Code-Guidelines/">Code Guidelines</a>
</li>

                        
                            
<li >
    <a href="../../Style-Guidelines/">Style Guidelines</a>
</li>

                        
                            
<li >
    <a href="../../Validating-Code/">Validating Code</a>
</li>

                        
                            
<li >
    <a href="../../Code-Structure/">Code Structure</a>
</li>

                        
                            
<li >
    <a href="../../Creating-Documentation/">Creating Documentation</a>
</li>

                        
                            
<li >
    <a href="../../Support-New-OS/">Adding support for a new OS</a>
</li>

                        
                            
<li >
    <a href="../../Dynamic-Config/">Dynamic Config</a>
</li>

                        
                            
<li >
    <a href="../../Sensor-State-Support/">Sensor State Support</a>
</li>

                        
                            
<li >
    <a href="../../Merging-Pull-Requests/">Merging Pull Requests</a>
</li>

                        
                            
<li >
    <a href="../../Creating-Release/">Creating Release</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../API/API-Docs/">API</a>
                    </li>
                
                
                
                    <li id="dropdown-Support" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Support/1-Minute-Polling/">1 Minute Polling</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Configuration/">Configuration</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Discovery Support/">Discovery Support</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Example-Hardware-Setup/">Example Hardware Setup</a>
</li>

                        
                            
<li >
    <a href="../../../Support/FAQ/">FAQ</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Features/">Features</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Install Validation/">Install Validation</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Performance/">Performance</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Poller Support/">Poller Support</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Remote-Monitoring-VPN/">Remote Monitoring VPN</a>
</li>

                        
                            
<li >
    <a href="../../../Support/SNMP-Configuration-Examples/">SNMP Configuration Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-hidden" class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">hidden <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Installation/Installation-Ubuntu-1404-Nginx/">Ubuntu 14.04 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-Ubuntu-1404-Apache/">Ubuntu 14.04 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-Ubuntu-1404-Lighttpd/">Ubuntu 14.04 (Lighttpd)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-CentOS-6-Apache-Nginx/">CentOS 6 (Apache/Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-(Debian-Ubuntu)/">Installation (Debian Ubuntu)</a>
</li>

                        
                            
<li >
    <a href="../../../Installation/Installation-(RHEL-CentOS)/">Installation (RHEL CentOS)</a>
</li>

                        
                            
<li >
    <a href="../../../Support/Support-New-OS/">Support New OS</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/Agent-Setup/">Agent Setup</a>
</li>

                        
                            
<li >
    <a href="../../../Extensions/RRDCached-Security/">RRDCached Security</a>
</li>

                        
                            
<li >
    <a href="../Initial-Detection/">Initial Detection</a>
</li>

                        
                            
<li >
    <a href="../Mem-CPU-Information/">Mem CPU Information</a>
</li>

                        
                            
<li >
    <a href="../Test-Units/">Test Units</a>
</li>

                        
                            
<li >
    <a href="../Health-Information/">Health Information</a>
</li>

                        
                            
<li class="active">
    <a href="./">Custom Graphs</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i>
                        <span class="visible-xs-inline visible-md-inline visible-lg-inline">Search</span>
                    </a>
                </li>
                
                
                    <li>
                        <a href="https://github.com/librenms/librenms">
                            
                                <i class="fa fa-github"></i>
                            
                            <span class="visible-xs-inline visible-lg-inline">GitHub</span>
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="row">
            
                
                    <div class="col-md-3">
<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#polling-os">Polling OS</a></li>
        
    
        <li class="main "><a href="#displaying">Displaying</a></li>
        
    
    </ul>
</div>
</div>
                    <div class="col-md-9" role="main">
<div class="row">
  <div class="source-links col-md-offset-8 col-md-4">

    <a href="https://github.com/librenms/librenms/edit/master/doc/Developing/os/Custom-Graphs.md" target="_blank"><i class="fa fa-pencil"></i> Edit on GitHub</a>

  </div>
</div>


<p>If you are adding custom graphs, please add the following to <code>includes/definitions.inc.php</code>:</p>
<pre><code class="php">//Don't forget to declare the specific graphs if needed. It will be located near the end of the file.

//Pulse Secure Graphs
$config['graph_types']['device']['pulse_users']['section']         = 'firewall';
$config['graph_types']['device']['pulse_users']['order']           = '0';
$config['graph_types']['device']['pulse_users']['descr']           = 'Active Users';
$config['graph_types']['device']['pulse_sessions']['section']      = 'firewall';
$config['graph_types']['device']['pulse_sessions']['order']        = '0';
$config['graph_types']['device']['pulse_sessions']['descr']        = 'Active Sessions';
</code></pre>

<h4 id="polling-os">Polling OS</h4>
<p>OS polling is not necessarily where custom polling should be done, please speak to one of the core devs in irc for guidance.</p>
<p>Let's update our example file to add additional polling:</p>
<pre><code class="bash">includes/polling/os/pulse.inc.php
</code></pre>

<p>We declare two specific graphs for users and sessions numbers. Theses two graphs will be displayed on the firewall section of the graphs tab as it was written in the definition include file.</p>
<pre><code class="php">&lt;?php

$users = snmp_get($device, 'iveConcurrentUsers.0', '-OQv', 'PULSESECURE-PSG-MIB');

if (is_numeric($users)) {
    $rrd_def = 'DS:users:GAUGE:600:0:U';

    $fields = array(
        'users' =&gt; $users,
    );

    $tags = compact('rrd_def');
    data_update($device, 'pulse_users', $tags, $fields);
    $graphs['pulse_users'] = true;
}

$sessions = snmp_get($device, 'iveConcurrentUsers.0', '-OQv', 'PULSESECURE-PSG-MIB');

if (is_numeric($sessions)) {
    $rrd_def = 'DS:sessions:GAUGE:600:0:U';

    $fields = array(
        'sessions' =&gt; $sessions,
    );

    $tags = compact('rrd_def');
    data_update($device, 'pulse_sessions', $tags, $fields);
    $graphs['pulse_sessions'] = true;
}
</code></pre>

<p>We finish in the declaration of the two graph types in the database:</p>
<p>We can do that within a file to share our work and contribute in the development of LibreNMS. :-)</p>
<pre><code class="bash">sql-schema/xxx.sql
php includes/sql-schema/update.php
./scripts/build-schema.php
</code></pre>

<p>Or put the SQL commands directly in Mysql or PhpMyadmin for our tests:</p>
<pre><code class="php">INSERT INTO `graph_types`(`graph_type`, `graph_subtype`, `graph_section`, `graph_descr`, `graph_order`) VALUES ('device',  'pulse_users',  'firewall',  'Active Users',  '');
INSERT INTO `graph_types`(`graph_type`, `graph_subtype`, `graph_section`, `graph_descr`, `graph_order`) VALUES ('device',  'pulse_sessions',  'firewall',  'Active Sessions',  '');
</code></pre>

<h4 id="displaying">Displaying</h4>
<p>The specific graphs are not displayed automatically so we need to write the following PHP code:</p>
<p><strong>Pulse Sessions</strong></p>
<pre><code class="bash">html/includes/graphs/device/pulse_sessions.inc.php
</code></pre>

<pre><code class="php">&lt;?php

$rrd_filename = rrd_name($device['hostname'], 'pulse_sessions');

require 'includes/graphs/common.inc.php';

$ds = 'sessions';

$colour_area = '9999cc';
$colour_line = '0000cc';

$colour_area_max = '9999cc';

$graph_max = 1;
$graph_min = 0;

$unit_text = 'Sessions';

require 'includes/graphs/generic_simplex.inc.php';
</code></pre>

<p><strong>Pulse Users</strong></p>
<pre><code class="bash">html/includes/graphs/device/pulse_users.inc.php
</code></pre>

<pre><code class="php">&lt;?php

$rrd_filename = rrd_name($device['hostname'], 'pulse_users');

require 'includes/graphs/common.inc.php';

$ds = 'users';

$colour_area = '9999cc';
$colour_line = '0000cc';

$colour_area_max = '9999cc';

$graph_max = 1;

$unit_text = 'Users';

require 'includes/graphs/generic_simplex.inc.php';
</code></pre>

<p>That should be it, after data has started to be collected graphs should appear in the WebUI.</p></div>
                
            
            </div>
        </div>

        <footer>
            <div class="container">
                <hr>
                
                <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
            </div>
        </footer>

        <script src="../../../js/jquery-1.12.4.min.js"></script>
        <script src="../../../js/bootstrap-3.3.7.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
