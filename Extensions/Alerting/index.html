<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="LibreNMS">
        <link rel="canonical" href="http://docs.librenms.org/Extensions/Alerting/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	    <title>Alerting - LibreNMS Docs</title>

        <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.6.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/color.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../librenms.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-79149977-2', 'docs.librenms.org');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">LibreNMS Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li id="dropdown-Installation" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Installation/Installing-LibreNMS/">Installing LibreNMS</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Ubuntu-image/">Ubuntu VM Image</a>
</li>

                        
                            
<li >
    <a href="../../Installation/CentOS-image/">CentOS VM Image</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-Ubuntu-1604-Nginx/">Ubuntu 16.04 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-Ubuntu-1604-Apache/">Ubuntu 16.04 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-CentOS-7-Nginx/">CentOS 7 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-CentOS-7-Apache/">CentOS 7 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installing-LibreNMS/">Older Docs</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Migrating-from-Observium/">Migrating from Observium</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-General" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">General <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../General/Acknowledgement/">Acknowledgement</a>
</li>

                        
                            
<li >
    <a href="../../General/Callback-Stats-and-Privacy/">Callback Stats and Privacy</a>
</li>

                        
                            
<li >
    <a href="../../General/Changelog/">Changelog</a>
</li>

                        
                            
<li >
    <a href="../../General/Contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../../General/Credits/">Credits</a>
</li>

                        
                            
<li >
    <a href="../../General/Updating/">Updating</a>
</li>

                        
                            
<li >
    <a href="../../General/Releases/">Releases</a>
</li>

                        
                            
<li >
    <a href="../../General/Security/">Security</a>
</li>

                        
                            
<li >
    <a href="../../General/Welcome-to-Observium-users/">Welcome to Observium users</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-Extensions" class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Extensions <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Alerting</a>
</li>

                        
                            
<li >
    <a href="../Applications/">Applications</a>
</li>

                        
                            
<li >
    <a href="../Authentication/">Authentication</a>
</li>

                        
                            
<li >
    <a href="../Auto-Discovery/">Auto Discovery</a>
</li>

                        
                            
<li >
    <a href="../Billing-Module/">Billing Module</a>
</li>

                        
                            
<li >
    <a href="../Component/">Component</a>
</li>

                        
                            
<li >
    <a href="../Dell-OpenManage/">Dell OpenManage</a>
</li>

                        
                            
<li >
    <a href="../Device-Groups/">Device Groups</a>
</li>

                        
                            
<li >
    <a href="../Distributed-Poller/">Distributed Poller</a>
</li>

                        
                            
<li >
    <a href="../Email-Alerting/">Email Alerting</a>
</li>

                        
                            
<li >
    <a href="../Globe-Frontpage/">Globe Frontpage</a>
</li>

                        
                            
<li >
    <a href="../Graylog/">Graylog</a>
</li>

                        
                            
<li >
    <a href="../Graphite/">Graphite</a>
</li>

                        
                            
<li >
    <a href="../IRC-Bot/">IRC Bot</a>
</li>

                        
                            
<li >
    <a href="../IRC-Bot-Extensions/">IRC Bot Extensions</a>
</li>

                        
                            
<li >
    <a href="../InfluxDB/">InfluxDB</a>
</li>

                        
                            
<li >
    <a href="../Interface-Description-Parsing/">Interface Description Parsing</a>
</li>

                        
                            
<li >
    <a href="../MIB-based-polling/">MIB based polling</a>
</li>

                        
                            
<li >
    <a href="../Memcached/">Memcached</a>
</li>

                        
                            
<li >
    <a href="../Network-Map/">Network Map</a>
</li>

                        
                            
<li >
    <a href="../NFSen/">NFSen</a>
</li>

                        
                            
<li >
    <a href="../Oxidized/">Oxidized</a>
</li>

                        
                            
<li >
    <a href="../PeeringDB/">PeeringDB</a>
</li>

                        
                            
<li >
    <a href="../Plugin-System/">Plugin System</a>
</li>

                        
                            
<li >
    <a href="../Poller-Service/">Poller Service</a>
</li>

                        
                            
<li >
    <a href="../Port-Description-Parser/">Port Description Parser</a>
</li>

                        
                            
<li >
    <a href="../Proxmox/">Proxmox</a>
</li>

                        
                            
<li >
    <a href="../RRDCached/">RRDCached</a>
</li>

                        
                            
<li >
    <a href="../RRDTune/">RRDTune</a>
</li>

                        
                            
<li >
    <a href="../SNMP-Proxy/">SNMP Proxy</a>
</li>

                        
                            
<li >
    <a href="../SNMP-Trap-Handler/">SNMP Trap Handler</a>
</li>

                        
                            
<li >
    <a href="../Services/">Services</a>
</li>

                        
                            
<li >
    <a href="../Smokeping/">Smokeping</a>
</li>

                        
                            
<li >
    <a href="../Sub-Directory/">Sub Directory</a>
</li>

                        
                            
<li >
    <a href="../Syslog/">Syslog</a>
</li>

                        
                            
<li >
    <a href="../Two-Factor-Auth/">Two Factor Auth</a>
</li>

                        
                            
<li >
    <a href="../Varnish/">Varnish</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-Developing" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developing <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Developing/Using-Git/">Using Git</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Code-Guidelines/">Code Guidelines</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Style-Guidelines/">Style Guidelines</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Validating-Code/">Validating Code</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Code-Structure/">Code Structure</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Creating-Documentation/">Creating Documentation</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Support-New-OS/">Adding support for a new OS</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Dynamic-Config/">Dynamic Config</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Sensor-State-Support/">Sensor State Support</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Merging-Pull-Requests/">Merging Pull Requests</a>
</li>

                        
                            
<li >
    <a href="../../Developing/Creating-Release/">Creating Release</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../API/API-Docs/">API</a>
                    </li>
                
                
                
                    <li id="dropdown-Support" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Support/1-Minute-Polling/">1 Minute Polling</a>
</li>

                        
                            
<li >
    <a href="../../Support/Configuration/">Configuration</a>
</li>

                        
                            
<li >
    <a href="../../Support/Discovery Support/">Discovery Support</a>
</li>

                        
                            
<li >
    <a href="../../Support/Example-Hardware-Setup/">Example Hardware Setup</a>
</li>

                        
                            
<li >
    <a href="../../Support/FAQ/">FAQ</a>
</li>

                        
                            
<li >
    <a href="../../Support/Features/">Features</a>
</li>

                        
                            
<li >
    <a href="../../Support/Install Validation/">Install Validation</a>
</li>

                        
                            
<li >
    <a href="../../Support/Performance/">Performance</a>
</li>

                        
                            
<li >
    <a href="../../Support/Poller Support/">Poller Support</a>
</li>

                        
                            
<li >
    <a href="../../Support/Remote-Monitoring-VPN/">Remote Monitoring VPN</a>
</li>

                        
                            
<li >
    <a href="../../Support/SNMP-Configuration-Examples/">SNMP Configuration Examples</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li id="dropdown-hidden" class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">hidden <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../Installation/Installation-Ubuntu-1404-Nginx/">Ubuntu 14.04 (Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-Ubuntu-1404-Apache/">Ubuntu 14.04 (Apache)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-Ubuntu-1404-Lighttpd/">Ubuntu 14.04 (Lighttpd)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-CentOS-6-Apache-Nginx/">CentOS 6 (Apache/Nginx)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-(Debian-Ubuntu)/">Installation (Debian Ubuntu)</a>
</li>

                        
                            
<li >
    <a href="../../Installation/Installation-(RHEL-CentOS)/">Installation (RHEL CentOS)</a>
</li>

                        
                            
<li >
    <a href="../../Support/Support-New-OS/">Support New OS</a>
</li>

                        
                            
<li >
    <a href="../Agent-Setup/">Agent Setup</a>
</li>

                        
                            
<li >
    <a href="../RRDCached-Security/">RRDCached Security</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Initial-Detection/">Initial Detection</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Mem-CPU-Information/">Mem CPU Information</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Test-Units/">Test Units</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Health-Information/">Health Information</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Wireless-Sensors/">Wireless Sensors</a>
</li>

                        
                            
<li >
    <a href="../../Developing/os/Custom-Graphs/">Custom Graphs</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i>
                        <span class="visible-xs-inline visible-md-inline visible-lg-inline">Search</span>
                    </a>
                </li>
                
                
                    <li>
                        <a href="https://github.com/librenms/librenms">
                            
                                <i class="fa fa-github"></i>
                            
                            <span class="visible-xs-inline visible-lg-inline">GitHub</span>
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="row">
            
                
                    <div class="col-md-3">
<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#about">About</a></li>
        
    
        <li class="main "><a href="#rules">Rules</a></li>
        
            <li><a href="#syntax">Syntax</a></li>
        
            <li><a href="#examples">Examples</a></li>
        
            <li><a href="#procedure">Procedure</a></li>
        
    
        <li class="main "><a href="#templates">Templates</a></li>
        
            <li><a href="#syntax_1">Syntax</a></li>
        
            <li><a href="#examples_1">Examples</a></li>
        
            <li><a href="#included">Included</a></li>
        
    
        <li class="main "><a href="#transports">Transports</a></li>
        
            <li><a href="#e-mail">E-Mail</a></li>
        
            <li><a href="#api">API</a></li>
        
            <li><a href="#nagios-compatible">Nagios Compatible</a></li>
        
            <li><a href="#irc">IRC</a></li>
        
            <li><a href="#slack">Slack</a></li>
        
            <li><a href="#rocketchat">Rocket.chat</a></li>
        
            <li><a href="#hipchat">HipChat</a></li>
        
            <li><a href="#pagerduty">PagerDuty</a></li>
        
            <li><a href="#pushover">Pushover</a></li>
        
            <li><a href="#boxcar">Boxcar</a></li>
        
            <li><a href="#telegram">Telegram</a></li>
        
            <li><a href="#pushbullet">Pushbullet</a></li>
        
            <li><a href="#clickatell">Clickatell</a></li>
        
            <li><a href="#playsms">PlaySMS</a></li>
        
            <li><a href="#victorops">VictorOps</a></li>
        
            <li><a href="#canopsis">Canopsis</a></li>
        
            <li><a href="#osticket">osTicket</a></li>
        
            <li><a href="#microsoft-teams">Microsoft Teams</a></li>
        
            <li><a href="#cisco-spark">Cisco Spark</a></li>
        
            <li><a href="#smseagle">SMSEagle</a></li>
        
            <li><a href="#syslog">Syslog</a></li>
        
    
        <li class="main "><a href="#entities">Entities</a></li>
        
            <li><a href="#devices">Devices</a></li>
        
            <li><a href="#bgp-peers">BGP Peers</a></li>
        
            <li><a href="#ipsec-tunnels">IPSec Tunnels</a></li>
        
            <li><a href="#memory-pools">Memory pools</a></li>
        
            <li><a href="#ports">Ports</a></li>
        
            <li><a href="#processors">Processors</a></li>
        
            <li><a href="#storage">Storage</a></li>
        
    
        <li class="main "><a href="#macros">Macros</a></li>
        
            <li><a href="#device-boolean">Device</a></li>
        
            <li><a href="#port-boolean">Port</a></li>
        
            <li><a href="#time">Time</a></li>
        
            <li><a href="#sensors-boolean">Sensors</a></li>
        
            <li><a href="#misc-boolean">Misc</a></li>
        
    
        <li class="main "><a href="#additional-options">Additional Options</a></li>
        
    
    </ul>
</div>
</div>
                    <div class="col-md-9" role="main">
<div class="row">
  <div class="source-links col-md-offset-8 col-md-4">

    <a href="https://github.com/librenms/librenms/edit/master/doc/Extensions/Alerting.md" target="_blank"><i class="fa fa-pencil"></i> Edit on GitHub</a>

  </div>
</div>


<p>Table of Content:</p>
<ul>
<li><a href="#about">About</a></li>
<li><a href="#rules">Rules</a><ul>
<li><a href="#rules-syntax">Syntax</a></li>
<li><a href="#rules-examples">Examples</a></li>
<li><a href="#rules-procedure">Procedure</a></li>
</ul>
</li>
<li><a href="#templates">Templates</a><ul>
<li><a href="#templates-syntax">Syntax</a></li>
<li><a href="#templates-examples">Examples</a></li>
<li><a href="#templates-included">Included</a></li>
</ul>
</li>
<li><a href="#transports">Transports</a><ul>
<li><a href="#transports-email">E-Mail</a></li>
<li><a href="#transports-api">API</a></li>
<li><a href="#transports-nagios">Nagios-Compatible</a></li>
<li><a href="#transports-irc">IRC</a></li>
<li><a href="#transports-slack">Slack</a></li>
<li><a href="#transports-rocket">Rocket.chat</a></li>
<li><a href="#transports-hipchat">HipChat</a></li>
<li><a href="#transports-pagerduty">PagerDuty</a></li>
<li><a href="#transports-pushover">Pushover</a></li>
<li><a href="#transports-boxcar">Boxcar</a></li>
<li><a href="#transports-telegram">Telegram</a></li>
<li><a href="#transports-pushbullet">Pushbullet</a></li>
<li><a href="#transports-clickatell">Clickatell</a></li>
<li><a href="#transports-playsms">PlaySMS</a></li>
<li><a href="#transports-victorops">VictorOps</a></li>
<li><a href="#transports-canopsis">Canopsis</a></li>
<li><a href="#transports-osticket">osTicket</a></li>
<li><a href="#transports-msteams">Microsoft Teams</a></li>
<li><a href="#transports-ciscospark">Cisco Spark</a></li>
<li><a href="#transports-smseagle">SMSEagle</a></li>
<li><a href="#transports-syslog">Syslog</a></li>
</ul>
</li>
<li><a href="#entities">Entities</a><ul>
<li><a href="#entity-devices">Devices</a></li>
<li><a href="#entity-bgppeers">BGP Peers</a></li>
<li><a href="#entity-ipsec">IPSec Tunnels</a></li>
<li><a href="#entity-mempools">Memory Pools</a></li>
<li><a href="#entity-ports">Ports</a></li>
<li><a href="#entity-processors">Processors</a></li>
<li><a href="#entity-storage">Storage</a></li>
</ul>
</li>
<li><a href="#macros">Macros</a><ul>
<li><a href="#macros-device">Device</a></li>
<li><a href="#macros-port">Port</a></li>
<li><a href="#macros-time">Time</a></li>
<li><a href="#macros-sensors">Sensors</a></li>
<li><a href="#macros-misc">Misc</a></li>
</ul>
</li>
<li><a href="#extra">Additional Options</a></li>
</ul>
<h1 id="about"><a name="about">About</a></h1>
<p>LibreNMS includes a highly customizable alerting system.
The system requires a set of user-defined rules to evaluate the situation of each device, port, service or any other entity.</p>
<blockquote>
<p>You can configure all options for alerting and transports via the WebUI, config options in this document are crossed out but left for reference.</p>
</blockquote>
<p>This document only covers the usage of it. See the <a href="https://github.com/f0o/glowing-tyrion/blob/master/DEVELOPMENT.md">DEVELOPMENT.md</a> for code-documentation.</p>
<h1 id="rules"><a name="rules">Rules</a></h1>
<p>Rules are defined using a logical language.
The GUI provides a simple way of creating basic as well as complex Rules in a self-describing manner.
More complex rules can be written manually.</p>
<h2 id="syntax"><a name="rules-syntax">Syntax</a></h2>
<p>Rules must consist of at least 3 elements: An <strong>Entity</strong>, a <strong>Condition</strong> and a <strong>Value</strong>.
Rules can contain braces and <strong>Glues</strong>.
<strong>Entities</strong> are provided as <code>%</code>-Noted pair of Table and Field. For Example: <code>%ports.ifOperStatus</code>.
<strong>Conditions</strong> can be any of:</p>
<ul>
<li>Equals <code>=</code></li>
<li>Not Equals <code>!=</code></li>
<li>Like <code>~</code></li>
<li>Not Like <code>!~</code></li>
<li>Greater <code>&gt;</code></li>
<li>Greater or Equal <code>&gt;=</code></li>
<li>Smaller <code>&lt;</code></li>
<li>Smaller or Equal <code>&lt;=</code></li>
</ul>
<p><strong>Values</strong> can be Entities or any single-quoted data.
<strong>Glues</strong> can be either <code>&amp;&amp;</code> for <code>AND</code> or <code>||</code> for <code>OR</code>.</p>
<p><strong>Note</strong>: The difference between <code>Equals</code> and <code>Like</code> (and its negation) is that <code>Equals</code> does a strict comparison and <code>Like</code> allows the usage of RegExp.
Arithmetics are allowed as well.</p>
<h2 id="examples"><a name="rules-examples">Examples</a></h2>
<p>Alert when:</p>
<ul>
<li>Device goes down: <code>%devices.status != '1'</code></li>
<li>Any port changes: <code>%ports.ifOperStatus != 'up'</code></li>
<li>Root-directory gets too full: <code>%storage.storage_descr = '/' &amp;&amp; %storage.storage_perc &gt;= '75'</code></li>
<li>Any storage gets fuller than the 'warning': <code>%storage.storage_perc &gt;= %storage_perc_warn</code></li>
<li>If device is a server and the used storage is above the warning level, but ignore /boot partitions: <code>%storage.storage_perc &gt; %storage.storage_perc_warn &amp;&amp; %devices.type = "server" &amp;&amp; %storage.storage_descr !~ "/boot"</code></li>
<li>VMware LAG is not using "Source ip address hash" load balancing: <code>%devices.os = "vmware" &amp;&amp; %ports.ifType = "ieee8023adLag" &amp;&amp; %ports.ifDescr !~ "Link Aggregation @, load balancing algorithm: Source ip address hash"</code></li>
<li>Syslog, authentication failure during the last 5m: <code>%syslog.timestamp &gt;= %macros.past_5m &amp;&amp; %syslog.msg ~ "@authentication failure@"</code></li>
<li>High memory usage: <code>%macros.device_up = "1" &amp;&amp; %mempools.mempool_perc &gt;= "90" &amp;&amp; %mempools.mempool_descr = "Virtual@"</code></li>
<li>High CPU usage(per core usage, not overall): <code>%macros.device_up = "1" &amp;&amp; %processors.processor_usage &gt;= "90"</code></li>
<li>High port usage, where description is not client &amp; ifType is not softwareLoopback: <code>%macros.port_usage_perc &gt;= "80" &amp;&amp; %port.port_descr_type != "client" &amp;&amp; %ports.ifType != "softwareLoopback"</code></li>
</ul>
<h2 id="procedure"><a name="rules-procedure">Procedure</a></h2>
<p>You can associate a rule to a procedure by giving the URL of the procedure when creating the rule. Only links like "http://" are supported, otherwise an error will be returned. Once configured, procedure can be opened from the Alert widget through the "Open" button, which can be shown/hidden from the widget configuration box.</p>
<h1 id="templates"><a name="templates">Templates</a></h1>
<p>Templates can be assigned to a single or a group of rules.
They can contain any kind of text.
The template-parser understands <code>if</code> and <code>foreach</code> controls and replaces certain placeholders with information gathered about the alert.</p>
<h2 id="syntax_1"><a name="templates-syntax">Syntax</a></h2>
<p>Controls:</p>
<ul>
<li>if-else (Else can be omitted):
<code>{if %placeholder == value}Some Text{else}Other Text{/if}</code></li>
<li>foreach-loop:
<code>{foreach %placeholder}Key: %key&lt;br/&gt;Value: %value{/foreach}</code></li>
</ul>
<p>Placeholders:</p>
<ul>
<li>Hostname of the Device: <code>%hostname</code></li>
<li>sysName of the Device: <code>%sysName</code></li>
<li>location of the Device: <code>%location</code></li>
<li>uptime of the Device (in seconds): <code>%uptime</code></li>
<li>short uptime of the Device (28d 22h 30m 7s): <code>%uptime_short</code></li>
<li>long uptime of the Device (28 days, 22h 30m 7s): <code>%uptime_long</code></li>
<li>description (purpose db field) of the Device: <code>%description</code></li>
<li>notes of the Device: <code>%notes</code></li>
<li>Title for the Alert: <code>%title</code></li>
<li>Time Elapsed, Only available on recovery (<code>%state == 0</code>): <code>%elapsed</code></li>
<li>Alert-ID: <code>%id</code></li>
<li>Unique-ID: <code>%uid</code></li>
<li>Faults, Only available on alert (<code>%state != 0</code>), must be iterated in a foreach (<code>{foreach %faults}</code>). Holds all available information about the Fault, accessible in the format <code>%value.Column</code>, for example: <code>%value.ifDescr</code>. Special field <code>%value.string</code> has most Identification-information (IDs, Names, Descrs) as single string, this is the equivalent of the default used.</li>
<li>State: <code>%state</code></li>
<li>Severity: <code>%severity</code></li>
<li>Rule: <code>%rule</code></li>
<li>Rule-Name: <code>%name</code></li>
<li>Timestamp: <code>%timestamp</code></li>
<li>Transport name: <code>%transport</code></li>
<li>Contacts, must be iterated in a foreach, <code>%key</code> holds email and <code>%value</code> holds name: <code>%contacts</code></li>
</ul>
<p>Placeholders can be used within the subjects for templates as well although %faults is most likely going to be worthless.</p>
<blockquote>
<p>NOTE: Placeholder names which are contained within another need to be ordered correctly. As an example:</p>
</blockquote>
<pre><code class="text">Limit: %value.sensor_limit / %value.sensor_limit_low
</code></pre>

<p>Should be done as:</p>
<pre><code class="text">Limit: %value.sensor_limit_low / %value.sensor_limit
</code></pre>

<p>The Default Template is a 'one-size-fit-all'. We highly recommend defining own templates for your rules to include more specific information.
Templates can be matched against several rules.</p>
<h2 id="examples_1"><a name="templates-examples">Examples</a></h2>
<p>Default Template:</p>
<pre><code class="text">%title\r\n
Severity: %severity\r\n
{if %state == 0}Time elapsed: %elapsed\r\n{/if}
Timestamp: %timestamp\r\n
Unique-ID: %uid\r\n
Rule: {if %name}%name{else}%rule{/if}\r\n
{if %faults}Faults:\r\n
{foreach %faults}  #%key: %value.string\r\n{/foreach}{/if}
Alert sent to: {foreach %contacts}%value &lt;%key&gt; {/foreach}
</code></pre>

<p>Conditional formatting example, will display a link to the host in email or just the hostname in any other transport:</p>
<pre><code class="text">{if %transport == mail}&lt;a href=&quot;https://my.librenms.install/device/device=%hostname/&quot;&gt;%hostname&lt;/a&gt;{else}%hostname{/if}
</code></pre>

<p>Note the use of double-quotes.  Single quotes (<code>'</code>) in templates will be escaped (replaced with <code>\'</code>) in the output and should therefore be avoided.</p>
<h2 id="included"><a name="templates-included">Included</a></h2>
<p>We include a few templates for you to use, these are specific to the type of alert rules you are creating. For example if you create a rule that would alert on BGP sessions then you can 
assign the BGP template to this rule to provide more information.</p>
<p>The included templates are:</p>
<ul>
<li>BGP Sessions</li>
<li>Ports</li>
<li>Temperature</li>
</ul>
<h1 id="transports"><a name="transports">Transports</a></h1>
<p>Transports are located within <code>$config['install_dir']/includes/alerts/transports.*.php</code> and defined as well as configured via <del><code>$config['alert']['transports']['Example'] = 'Some Options'</code></del>.</p>
<p>Contacts will be gathered automatically and passed to the configured transports.
By default the Contacts will be only gathered when the alert triggers and will ignore future changes in contacts for the incident. If you want contacts to be re-gathered before each dispatch, please set <del><code>$config['alert']['fixed-contacts'] = false;</code></del> in your config.php.</p>
<p>The contacts will always include the <code>SysContact</code> defined in the Device's SNMP configuration and also every LibreNMS-User that has at least <code>read</code>-permissions on the entity that is to be alerted.
At the moment LibreNMS only supports Port or Device permissions.
You can exclude the <code>SysContact</code> by setting:</p>
<pre><code class="php">$config['alert']['syscontact'] = false;
</code></pre>

<p>To include users that have <code>Global-Read</code> or <code>Administrator</code> permissions it is required to add these additions to the <code>config.php</code> respectively:</p>
<pre><code class="php">$config['alert']['globals'] = true; //Include Global-Read into alert-contacts
$config['alert']['admins']  = true; //Include Administrators into alert-contacts
</code></pre>

<h2 id="e-mail"><a name="transports-email">E-Mail</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p>For all but the default contact, we support setting multiple email addresses separated by a comma. So you can 
set the devices sysContact, override the sysContact or have your users emails set like:</p>
<p><code>email@domain.com, alerting@domain.com</code></p>
<p>E-Mail transport is enabled with adding the following to your <code>config.php</code>:
~</p>
<pre><code class="php">$config['alert']['transports']['mail'] = true;
</code></pre>

<p>~~</p>
<p>The E-Mail transports uses the same email-configuration like the rest of LibreNMS.
As a small reminder, here is it's configuration directives including defaults:
~~</p>
<pre><code class="php">$config['email_backend']                   = 'mail';               // Mail backend. Allowed: &quot;mail&quot; (PHP's built-in), &quot;sendmail&quot;, &quot;smtp&quot;.
$config['email_from']                      = NULL;                 // Mail from. Default: &quot;ProjectName&quot; &lt;projectid@`hostname`&gt;
$config['email_user']                      = $config['project_id'];
$config['email_sendmail_path']             = '/usr/sbin/sendmail'; // The location of the sendmail program.
$config['email_html']                      = FALSE;                // Whether to send HTML email as opposed to plaintext
$config['email_smtp_host']                 = 'localhost';          // Outgoing SMTP server name.
$config['email_smtp_port']                 = 25;                   // The port to connect.
$config['email_smtp_timeout']              = 10;                   // SMTP connection timeout in seconds.
$config['email_smtp_secure']               = NULL;                 // Enable encryption. Use 'tls' or 'ssl'
$config['email_smtp_auth']                 = FALSE;                // Whether or not to use SMTP authentication.
$config['email_smtp_username']             = NULL;                 // SMTP username.
$config['email_smtp_password']             = NULL;                 // Password for SMTP authentication.

$config['alert']['default_only']           = false;                //Only issue to default_mail
$config['alert']['default_mail']           = '';                   //Default email
</code></pre>

<p>~~</p>
<h2 id="api"><a name="transports-api">API</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p>API transports definitions are a bit more complex than the E-Mail configuration.
The basis for configuration is <del><code>$config['alert']['transports']['api'][METHOD]</code></del> where <code>METHOD</code> can be <code>get</code>,<code>post</code> or <code>put</code>.
This basis has to contain an array with URLs of each API to call.
The URL can have the same placeholders as defined in the <a href="#templates-syntax">Template-Syntax</a>.
If the <code>METHOD</code> is <code>get</code>, all placeholders will be URL-Encoded.
The API transport uses cURL to call the APIs, therefore you might need to install <code>php5-curl</code> or similar in order to make it work.
<strong>Note</strong>: it is highly recommended to define own <a href="#templates">Templates</a> when you want to use the API transport. The default template might exceed URL-length for GET requests and therefore cause all sorts of errors.</p>
<p>Example:
~~</p>
<pre><code class="php">$config['alert']['transports']['api']['get'][] = &quot;https://api.thirdparti.es/issue?apikey=abcdefg&amp;subject=%title&quot;;
</code></pre>

<p>~~</p>
<h2 id="nagios-compatible"><a name="transports-nagios">Nagios Compatible</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p>The nagios transport will feed a FIFO at the defined location with the same format that nagios would.
This allows you to use other Alerting-Systems to work with LibreNMS, for example <a href="http://flapjack.io">Flapjack</a>.
~~</p>
<pre><code class="php">$config['alert']['transports']['nagios'] = &quot;/path/to/my.fifo&quot;; //Flapjack expects it to be at '/var/cache/nagios3/event_stream.fifo'
</code></pre>

<p>~~</p>
<h2 id="irc"><a name="transports-irc">IRC</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p>The IRC transports only works together with the LibreNMS IRC-Bot.
Configuration of the LibreNMS IRC-Bot is described <a href="https://github.com/librenms/librenms/blob/master/doc/Extensions/IRC-Bot.md">here</a>.
~~</p>
<pre><code class="php">$config['alert']['transports']['irc'] = true;
</code></pre>

<p>~~</p>
<h2 id="slack"><a name="transports-slack">Slack</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>The Slack transport will POST the alert message to your Slack Incoming WebHook using the <a href="https://api.slack.com/docs/message-attachments">attachments</a> option, you are able to specify multiple webhooks along with the relevant options to go with it. Simple html tags are stripped from the message. All options are optional, the only required value is for url, without this then no call to Slack will be made. Below is an example of how to send alerts to two channels with different customised options: </p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['slack'][] = array('url' =&gt; &quot;https://hooks.slack.com/services/A12B34CDE/F56GH78JK/L901LmNopqrSTUVw2w3XYZAB4C&quot;, 'channel' =&gt; '#Alerting');

$config['alert']['transports']['slack'][] = array('url' =&gt; &quot;https://hooks.slack.com/services/A12B34CDE/F56GH78JK/L901LmNopqrSTUVw2w3XYZAB4C&quot;, 'channel' =&gt; '@john', 'username' =&gt; 'LibreNMS', 'icon_emoji' =&gt; ':ghost:');

</code></pre>

<p>~~</p>
<h2 id="rocketchat"><a name="transports-slack">Rocket.chat</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>The Rocket.chat transport will POST the alert message to your Rocket.chat Incoming WebHook using the <a href="https://rocket.chat/docs/developer-guides/rest-api/chat/postmessage">attachments</a> option, you are able to specify multiple webhooks along with the relevant options to go with it. Simple html tags are stripped from the message. All options are optional, the only required value is for url, without this then no call to Rocket.chat will be made. Below is an example of how to send alerts to two channels with different customised options:</p>
<pre><code class="php">$config['alert']['transports']['rocket'][] = array('url' =&gt; &quot;https://rocket.url/api/v1/chat.postMessage&quot;, 'channel' =&gt; '#Alerting');

$config['alert']['transports']['rocket'][] = array('url' =&gt; &quot;https://rocket.url/api/v1/chat.postMessage&quot;, 'channel' =&gt; '@john', 'username' =&gt; 'LibreNMS', 'icon_emoji' =&gt; ':ghost:');

</code></pre>

<h2 id="hipchat"><a name="transports-hipchat">HipChat</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>The HipChat transport requires the following:</p>
<p><strong>room_id</strong> = HipChat Room ID</p>
<p><strong>url</strong> = HipChat API URL+API Key</p>
<p><strong>from</strong> = The name that will be displayed</p>
<p>The HipChat transport makes the following optional:</p>
<p><strong>color</strong> = Any of HipChat's supported message colors</p>
<p><strong>message_format</strong> = Any of HipChat's supported message formats</p>
<p><strong>notify</strong> = 0 or 1</p>
<p>See the HipChat API Documentation for
<a href="https://www.hipchat.com/docs/api/method/rooms/message">rooms/message</a>
for details on acceptable values.</p>
<blockquote>
<p>You may notice that the link points at the "deprecated" v1 API.  This is
because the v2 API is still in beta.</p>
</blockquote>
<p>Below are two examples of sending messages to a HipChat room.</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['hipchat'][] = array(&quot;url&quot; =&gt; &quot;https://api.hipchat.com/v1/rooms/message?auth_token=9109jawregoaih&quot;,
                                                    &quot;room_id&quot; =&gt; &quot;1234567&quot;,
                                                    &quot;from&quot; =&gt; &quot;LibreNMS&quot;);

$config['alert']['transports']['hipchat'][] = array(&quot;url&quot; =&gt; &quot;https://api.hipchat.com/v1/rooms/message?auth_token=109jawregoaihj&quot;,
                                                    &quot;room_id&quot; =&gt; &quot;7654321&quot;,
                                                    &quot;from&quot; =&gt; &quot;LibreNMS&quot;,
                                                    &quot;color&quot; =&gt; &quot;red&quot;,
                                                    &quot;notify&quot; =&gt; 1,
                                                    &quot;message_format&quot; =&gt; &quot;text&quot;);
</code></pre>

<p>~~</p>
<blockquote>
<p>Note: The default message format for HipChat messages is HTML.  It is
recommended that you specify the <code>text</code> message format to prevent unexpected
results, such as HipChat attempting to interpret angled brackets (<code>&lt;</code> and
<code>&gt;</code>).</p>
</blockquote>
<h2 id="pagerduty"><a name="transports-pagerduty">PagerDuty</a></h2>
<blockquote>
<p>You can configure these options within the WebUI now, please avoid setting these options within config.php</p>
</blockquote>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Enabling PagerDuty transports is almost as easy as enabling email-transports.</p>
<p>All you need is to create a Service with type Generic API on your PagerDuty dashboard.</p>
<p>Now copy your API-Key from the newly created Service and setup the transport like:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['pagerduty'] = 'MYAPIKEYGOESHERE';
</code></pre>

<p>~~</p>
<p>That's it!</p>
<p><strong>Note</strong>: Currently ACK notifications are not transported to PagerDuty, This is going to be fixed within the next major version (version by date of writing: 2015.05)</p>
<h2 id="pushover"><a name="transports-pushover">Pushover</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Enabling Pushover support is fairly easy, there are only two required parameters.</p>
<p>Firstly you need to create a new Application (called LibreNMS, for example) in your account on the Pushover website (https://pushover.net/apps)</p>
<p>Now copy your API Token/Key from the newly created Application and setup the transport in your config.php like:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['pushover'][] = array(
                                                    &quot;appkey&quot; =&gt; 'APPLICATIONAPIKEYGOESHERE',
                                                    &quot;userkey&quot; =&gt; 'USERKEYGOESHERE',
                                                    );
</code></pre>

<p>~~</p>
<p>To modify the Critical alert sound, add the 'sound_critical' parameter, example:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['pushover'][] = array(
                                                    &quot;appkey&quot; =&gt; 'APPLICATIONAPIKEYGOESHERE',
                                                    &quot;userkey&quot; =&gt; 'USERKEYGOESHERE',
                                                    &quot;sound_critical&quot; =&gt; 'siren',
                                                    );
</code></pre>

<p>~~</p>
<h2 id="boxcar"><a name="transports-boxcar">Boxcar</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Enabling Boxcar support is super easy.
Copy your access token from the Boxcar app or from the Boxcar.io website and setup the transport in your config.php like:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['boxcar'][] = array(
                                                    &quot;access_token&quot; =&gt; 'ACCESSTOKENGOESHERE',
                                                    );
</code></pre>

<p>~~</p>
<p>To modify the Critical alert sound, add the 'sound_critical' parameter, example:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['boxcar'][] = array(
                                                    &quot;access_token&quot; =&gt; 'ACCESSTOKENGOESHERE',
                                                    &quot;sound_critical&quot; =&gt; 'detonator-charge',
                                                    );
</code></pre>

<p>~~</p>
<h2 id="telegram"><a name="transports-telegram">Telegram</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<blockquote>
<p>Thank you to <a href="https://github.com/snis">snis</a> for these instructions.</p>
</blockquote>
<ol>
<li>
<p>First you must create a telegram account and add BotFather to you list. To do this click on the following url: https://telegram.me/botfather</p>
</li>
<li>
<p>Generate a new bot with the command "/newbot" BotFather is then asking for a username and a normal name. After that your bot is created and you get a HTTP token. (for more options for your bot type "/help")</p>
</li>
<li>
<p>Add your bot to telegram with the following url: <code>http://telegram.me/&lt;botname&gt;</code> and send some text to the bot.</p>
</li>
<li>
<p>Now copy your token code and go to the following page in chrome: <code>https://api.telegram.org/bot&lt;tokencode&gt;/getUpdates</code></p>
</li>
<li>
<p>You see a json code with the message you sent to the bot. Copy the Chat id. In this example that is “-9787468”
   <code>"message":{"message_id":7,"from":"id":656556,"first_name":"Joo","last_name":"Doo","username":"JohnDoo"},"chat":{"id":-9787468,"title":"Telegram Group"},"date":1435216924,"text":"Hi"}}]}</code></p>
</li>
<li>
<p>Now create a new "Telegram transport" in LibreNMS (Global Settings -&gt; Alerting Settings -&gt; Telegram transport).
Click on 'Add Telegram config' and put your chat id and token into the relevant box.</p>
</li>
</ol>
<h2 id="pushbullet"><a name="transports-pushbullet">Pushbullet</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Enabling Pushbullet is a piece of cake.
Get your Access Token from your Pushbullet's settings page and set it in your config like:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['pushbullet'] = 'MYFANCYACCESSTOKEN';
</code></pre>

<p>~~</p>
<h2 id="clickatell"><a name="transports-clickatell">Clickatell</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Clickatell provides a REST-API requiring an Authorization-Token and at least one Cellphone number.
Please consult Clickatell's documentation regarding number formatting.
Here an example using 3 numbers, any amount of numbers is supported:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['clickatell']['token'] = 'MYFANCYACCESSTOKEN';
$config['alert']['transports']['clickatell']['to'][]  = '+1234567890';
$config['alert']['transports']['clickatell']['to'][]  = '+1234567891';
$config['alert']['transports']['clickatell']['to'][]  = '+1234567892';
</code></pre>

<p>~~</p>
<h2 id="playsms"><a name="transports-playsms">PlaySMS</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>PlaySMS is an open source SMS-Gateway that can be used via their HTTP-API using a Username and WebService-Token.
Please consult PlaySMS's documentation regarding number formatting.
Here an example using 3 numbers, any amount of numbers is supported:</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['playsms']['url']   = 'https://localhost/index.php?app=ws';
$config['alert']['transports']['playsms']['user']  = 'user1';
$config['alert']['transports']['playsms']['token'] = 'MYFANCYACCESSTOKEN';
$config['alert']['transports']['playsms']['from']  = '+1234567892'; //Optional
$config['alert']['transports']['playsms']['to'][]  = '+1234567890';
$config['alert']['transports']['playsms']['to'][]  = '+1234567891';
</code></pre>

<p>~~</p>
<h2 id="victorops"><a name="transports-victorops">VictorOps</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>VictorOps provide a webHook url to make integration extremely simple. To get the URL required login to your VictorOps account and go to:</p>
<p>Settings -&gt; Integrations -&gt; REST Endpoint -&gt; Enable Integration.</p>
<p>The URL provided will have $routing_key at the end, you need to change this to something that is unique to the system sending the alerts such as librenms. I.e:</p>
<p><code>https://alert.victorops.com/integrations/generic/20132414/alert/2f974ce1-08fc-4dg8-a4f4-9aee6cf35c98/librenms</code></p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['victorops']['url'] = 'https://alert.victorops.com/integrations/generic/20132414/alert/2f974ce1-08fc-4dg8-a4f4-9aee6cf35c98/librenms';
</code></pre>

<p>~~</p>
<h2 id="canopsis"><a name="transports-canopsis">Canopsis</a></h2>
<p>Canopsis is a hypervision tool. LibreNMS can send alerts to Canopsis which are then converted to canopsis events. To configure the transport, go to:</p>
<p>Global Settings -&gt; Alerting Settings -&gt; Canopsis Transport.</p>
<p>You will need to fill this paramaters :</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['canopsis']['host'] = 'www.xxx.yyy.zzz';
$config['alert']['transports']['canopsis']['port'] = '5672';
$config['alert']['transports']['canopsis']['user'] = 'admin';
$config['alert']['transports']['canopsis']['passwd'] = 'my_password';
$config['alert']['transports']['canopsis']['vhost'] = 'canopsis';
</code></pre>

<p>~~</p>
<p>For more information about canopsis and its events, take a look here :
 http://www.canopsis.org/
 http://www.canopsis.org/wp-content/themes/canopsis/doc/sakura/user-guide/event-spec.html</p>
<h2 id="osticket"><a name="transports-osticket">osTicket</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>osTicket, open source ticket system. LibreNMS can send alerts to osTicket API which are then converted to osTicket tickets. To configure the transport, go to:</p>
<p>Global Settings -&gt; Alerting Settings -&gt; osTicket Transport.</p>
<p>This can also be done manually in config.php :</p>
<p>~~</p>
<pre><code class="php">$config['alert']['transports']['osticket']['url'] = 'http://osticket.example.com/api/http.php/tickets.json';
$config['alert']['transports']['osticket']['token'] = '123456789';
</code></pre>

<p>~~</p>
<h2 id="microsoft-teams"><a name="transports-msteams">Microsoft Teams</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Microsoft Teams. LibreNMS can send alerts to Microsoft Teams Connector API which are then posted to a specific channel. To configure the transport, go to:</p>
<p>Global Settings -&gt; Alerting Settings -&gt; Microsoft Teams Transport.</p>
<p>This can also be done manually in config.php :</p>
<p>~</p>
<pre><code class="php">$config['alert']['transports']['msteams']['url'] = 'https://outlook.office365.com/webhook/123456789';
</code></pre>

<p>~</p>
<h2 id="cisco-spark"><a name="transports-ciscospark">Cisco Spark</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>Cisco Spark. LibreNMS can send alerts to a Cisco Spark room. To make this possible you need to have a RoomID and a token. </p>
<p>For more information about Cisco Spark RoomID and token, take a look here :
 https://developer.ciscospark.com/getting-started.html
 https://developer.ciscospark.com/resource-rooms.html</p>
<p>To configure the transport, go to:</p>
<p>Global Settings -&gt; Alerting Settings -&gt; Cisco Spark transport.</p>
<p>This can also be done manually in config.php :</p>
<p>~</p>
<pre><code class="php">$config['alert']['transports']['ciscospark']['token'] = '1234567890QWERTYUIOP';
$config['alert']['transports']['ciscospark']['roomid'] = '1234567890QWERTYUIOP';
</code></pre>

<p>~</p>
<h2 id="smseagle"><a name="transports-smseagle">SMSEagle</a></h2>
<p><a href="../../Support/Configuration/#proxy-support">Using a proxy?</a></p>
<p>SMSEagle is a hardware SMS Gateway that can be used via their HTTP-API using a Username and password
Please consult their documentation at <a href="http://www.smseagle.eu">www.smseagle.eu</a>
Destination numbers are one per line, with no spaces. They can be in either local or international dialling format.</p>
<p>~</p>
<pre><code class="php">$config['alert']['transports']['smseagle']['url']   = 'ip.add.re.ss';
$config['alert']['transports']['smseagle']['user']  = 'smseagle_user';
$config['alert']['transports']['smseagle']['token'] = 'smseagle_user_password';
$config['alert']['transports']['smseagle']['to'][]  = '+3534567890';
$config['alert']['transports']['smseagle']['to'][]  = '0834567891';
</code></pre>

<p>~</p>
<h2 id="syslog"><a name="transports-syslog">Syslog</a></h2>
<p>You can have LibreNMS emit alerts as syslogs complying with RFC 3164.
More information on RFC 3164 can be found here: https://tools.ietf.org/html/rfc3164
Example output: <code>&lt;26&gt; Mar 22 00:59:03 librenms.host.net librenms[233]: [Critical] network.device.net: Port Down - port_id =&gt; 98939; ifDescr =&gt; xe-1/1/0;</code>
Each fault will be sent as a separate syslog.</p>
<p>~</p>
<pre><code class="php">$config['alert']['transports']['syslog']['syslog_host']   = '127.0.0.1';
$config['alert']['transports']['syslog']['syslog_port']  = 514;
$config['alert']['transports']['syslog']['syslog_facility'] = 3;
</code></pre>

<p>~</p>
<h1 id="entities"><a name="entities">Entities</h1>
<p>Entities as described earlier are based on the table and column names within the database, if you are unsure of what the entity is you want then have a browse around inside MySQL using <code>show tables</code> and <code>desc &lt;tablename&gt;</code>.</p>
<h2 id="devices"><a name="entity-devices">Devices</a></h2>
<p><strong>devices.hostname</strong> = The devices hostname.</p>
<p><strong>devices.location</strong> = The devices location.</p>
<p><strong>devices.status</strong> = The status of the device, 1 = up, 0 = down.</p>
<p><strong>devices.status_reason</strong> = The reason the device was detected as down (icmp or snmp).</p>
<p><strong>devices.ignore</strong> = If the device is ignored this will be set to 1.</p>
<p><strong>devices.disabled</strong> = If the device is disabled this will be set to 1.</p>
<p><strong>devices.last_polled</strong> = The the last polled datetime (yyyy-mm-dd hh:mm:ss).</p>
<p><strong>devices.type</strong> = The device type such as network, server, firewall, etc.</p>
<h2 id="bgp-peers"><a name="entity-bgppeers">BGP Peers</a></h2>
<p><strong>bgpPeers.astext</strong> = This is the description of the BGP Peer.</p>
<p><strong>bgpPeers.bgpPeerIdentifier</strong> = The IP address of the BGP Peer.</p>
<p><strong>bgpPeers.bgpPeerRemoteAs</strong> = The AS number of the BGP Peer.</p>
<p><strong>bgpPeers.bgpPeerState</strong> = The operational state of the BGP session.</p>
<p><strong>bgpPeers.bgpPeerAdminStatus</strong> = The administrative state of the BGP session.</p>
<p><strong>bgpPeers.bgpLocalAddr</strong> = The local address of the BGP session.</p>
<h2 id="ipsec-tunnels"><a name="entity-ipsec">IPSec Tunnels</a></h2>
<p><strong>ipsec_tunnels.peer_addr</strong> = The remote VPN peer address.</p>
<p><strong>ipsec_tunnels.local_addr</strong> = The local VPN address.</p>
<p><strong>ipsec_tunnels.tunnel_status</strong> = The VPN tunnels operational status.</p>
<h2 id="memory-pools"><a name="entity-mempools">Memory pools</a></h2>
<p><strong>mempools.mempool_type</strong> = The memory pool type such as hrstorage, cmp and cemp.</p>
<p><strong>mempools.mempool_descr</strong> = The description of the pool such as Physical memory, Virtual memory and System memory.</p>
<p><strong>mempools.mempool_perc</strong> = The used percentage of the memory pool.</p>
<h2 id="ports"><a name="entity-ports">Ports</a></h2>
<p><strong>ports.ifDescr</strong> = The interface description.</p>
<p><strong>ports.ifName</strong> = The interface name.</p>
<p><strong>ports.ifSpeed</strong> = The port speed in bps.</p>
<p><strong>ports.ifHighSpeed</strong> = The port speed in mbps.</p>
<p><strong>ports.ifOperStatus</strong> = The operational status of the port (up or down).</p>
<p><strong>ports.ifAdminStatus</strong> = The administrative status of the port (up or down).</p>
<p><strong>ports.ifDuplex</strong> = Duplex setting of the port.</p>
<p><strong>ports.ifMtu</strong> = The MTU setting of the port.</p>
<h2 id="processors"><a name="entity-processors">Processors</a></h2>
<p><strong>processors.processor_usage</strong> = The usage of the processor as a percentage.</p>
<p><strong>processors.processor_descr</strong> = The description of the processor.</p>
<h2 id="storage"><a name="entity-storage">Storage</a></h2>
<p><strong>storage.storage_descr</strong> = The description of the storage.</p>
<p><strong>storage.storage_perc</strong> = The usage of the storage as a percentage.</p>
<h1 id="macros"><a name="macros">Macros</a></h1>
<p>Macros are shorthands to either portion of rules or pure SQL enhanced with placeholders.
You can define your own macros in your <code>config.php</code>.</p>
<p>Example macro-implementation of Debian-Devices</p>
<pre><code class="php">$config['alert']['macros']['rule']['is_debian'] = '%devices.features ~ &quot;@debian@&quot;';
</code></pre>

<p>And in the Rule:</p>
<pre><code>...  &amp;&amp; %macros.is_debian = &quot;1&quot; &amp;&amp; ...
</code></pre>

<p>This Example-macro is a Boolean-macro, it applies a form of filter to the set of results defined by the rule.
All macros that are not unary should return Boolean.</p>
<p>You can only apply <em>Equal</em> or <em>Not-Equal</em> Operations on Boolean-macros where <code>True</code> is represented by <code>"1"</code> and <code>False</code> by <code>"0"</code>.</p>
<p>Note, if using a /, spaces must be inserted around it.</p>
<p>Example </p>
<pre><code class="php">((%ports.ifInOctets_rate*8) / %ports.ifSpeed)*100
</code></pre>

<h2 id="device-boolean"><a name="macros-device">Device</a> (Boolean)</h2>
<p>Entity: <code>%macros.device</code></p>
<p>Description: Only select devices that aren't deleted, ignored or disabled.</p>
<p>Source: <code>(%devices.disabled = "0" &amp;&amp; %devices.ignore = "0")</code></p>
<h3 id="device-is-up-boolean"><a name="macros-device-up">Device is up</a> (Boolean)</h3>
<p>Entity: <code>%macros.device_up</code></p>
<p>Description: Only select devices that are up.</p>
<p>Implies: %macros.device</p>
<p>Source: <code>(%devices.status = "1" &amp;&amp; %macros.device)</code></p>
<h3 id="device-is-down-boolean"><a name="macros-device-down">Device is down</a> (Boolean)</h3>
<p>Entity: <code>%macros.device_down</code></p>
<p>Description: Only select devices that are down.</p>
<p>Implies: %macros.device</p>
<p>Source: <code>(%devices.status = "0" &amp;&amp; %macros.device)</code></p>
<h2 id="port-boolean"><a name="macros-port">Port</a> (Boolean)</h2>
<p>Entity: <code>%macros.port</code></p>
<p>Description: Only select ports that aren't deleted, ignored or disabled.</p>
<p>Source: <code>(%ports.deleted = "0" &amp;&amp; %ports.ignore = "0" &amp;&amp; %ports.disabled = "0")</code></p>
<h3 id="port-is-up-boolean"><a name="macros-port-up">Port is up</a> (Boolean)</h3>
<p>Entity: <code>%macros.port_up</code></p>
<p>Description: Only select ports that are up and also should be up.</p>
<p>Implies: %macros.port</p>
<p>Source: <code>(%ports.ifOperStatus = "up" &amp;&amp; %ports.ifAdminStatus = "up" &amp;&amp; %macros.port)</code></p>
<h3 id="port-is-down-boolean"><a name="macros-port-down">Port is down</a> (Boolean)</h3>
<p>Entity: <code>%macros.port_down</code></p>
<p>Description: Only select ports that are down.</p>
<p>Implies: %macros.port</p>
<p>Source: <code>(%ports.ifOperStatus = "down" &amp;&amp; %ports.ifAdminStatus != "down" &amp;&amp; %macros.port)</code></p>
<h3 id="port-usage-in-percent-decimal"><a name="macros-port-usage-perc">Port-Usage in Percent</a> (Decimal)</h3>
<p>Entity: <code>%macros.port_usage_perc</code></p>
<p>Description: Return port-usage in percent.</p>
<p>Source: <code>((%ports.ifInOctets_rate*8) / %ports.ifSpeed)*100</code></p>
<h2 id="time"><a name="macros-time">Time</a></h2>
<h3 id="now-datetime"><a name="macros-time-now">Now</a> (Datetime)</h3>
<p>Entity: <code>%macros.now</code></p>
<p>Description: Alias of MySQL's NOW()</p>
<p>Source: <code>NOW()</code></p>
<h3 id="past-n-minutes-datetime"><a name="macros-time-past-Nm">Past N Minutes</a> (Datetime)</h3>
<p>Entity: <code>%macros.past_$m</code></p>
<p>Description: Returns a MySQL Timestamp dated <code>$</code> Minutes in the past. <code>$</code> can only be a supported Resolution.</p>
<p>Example: <code>%macros.past_5m</code> is Last 5 Minutes.</p>
<p>Resolution: 5,10,15,30,60</p>
<p>Source: <code>DATE_SUB(NOW(),INTERVAL $ MINUTE)</code></p>
<h2 id="sensors-boolean"><a name="macros-sensors">Sensors</a> (Boolean)</h2>
<p>Entity: <code>%macros.sensor</code></p>
<p>Description: Only select sensors that aren't ignored.</p>
<p>Source: <code>(%sensors.sensor_alert = 1)</code></p>
<h2 id="misc-boolean"><a name="macros-misc">Misc</a> (Boolean)</h2>
<h3 id="packet-loss">Packet Loss</h3>
<p>Entity: <code>(%macros.packet_loss_5m)</code></p>
<p>Description: Packet loss % value for the device within the last 5 minutes.</p>
<p>Example: <code>%macros.packet_loss_5m</code> &gt; 50</p>
<p>Entity: <code>(%macros.packet_loss_15m)</code></p>
<p>Description: Packet loss % value for the device within the last 15 minutes.</p>
<p>Example: <code>%macros.packet_loss_15m</code> &gt; 50</p>
<h3 id="ports-in-usage-perc-int">Ports in usage perc (Int)</h3>
<p>Entity: <code>((%ports.ifInOctets_rate*8)/%ports.ifSpeed)*100</code></p>
<p>Description: Port in used more than 50%</p>
<p>Example: `%macros.port_in_usage_perc &gt; 50</p>
<h3 id="ports-out-usage-perc-int">Ports out usage perc (Int)</h3>
<p>Entity: <code>((%ports.ifOutOctets_rate*8)/%ports.ifSpeed)*100</code></p>
<p>Description: Port out used more than 50%</p>
<p>Example: `%macros.port_out_usage_perc &gt; 50</p>
<h3 id="ports-now-down-boolean">Ports now down (Boolean)</h3>
<p>Entity: <code>%ports.ifOperStatus != %ports.ifOperStatus_prev &amp;&amp; %ports.ifOperStatus_prev = "up" &amp;&amp; %ports.ifAdminStatus = "up"</code></p>
<p>Description: Ports that were previously up and have now gone down.</p>
<p>Example: <code>%macros.port_now_down = "1"</code></p>
<h3 id="device-component-down-junos">Device component down [JunOS]</h3>
<p>Entity: <code>%sensors.sensor_class = "state" &amp;&amp; %sensors.sensor_current != "6" &amp;&amp; %sensors.sensor_type = "jnxFruState" &amp;&amp; %sensors.sensor_current != "2"</code></p>
<p>Description: Device component is down such as Fan, PSU, etc for JunOS devices.</p>
<p>Example: <code>%macros.device_component_down_junos = "1"</code></p>
<h3 id="device-component-down-cisco">Device component down [Cisco]</h3>
<p>Entity: <code>%sensors.sensor_current != "1" &amp;&amp; %sensors.sensor_current != "5" &amp;&amp; %sensors.sensor_type ~ "^cisco.*State$"</code></p>
<p>Description: Device component is down such as Fan, PSU, etc for Cisco devices.</p>
<p>Example: <code>%macros.device_component_down_cisco = "1"</code></p>
<h3 id="pdu-over-amperage-apc">PDU over amperage [APC]</h3>
<p>Entity: <code>%sensors.sensor_class = "current" &amp;&amp; %sensors.sensor_descr = "Bank Total" &amp;&amp; %sensors.sensor_current &gt; %sensors.sensor_limit &amp;&amp; %devices.os = "apc"</code></p>
<p>Description: APC PDU over amperage</p>
<p>Example: <code>%macros.pdu_over_amperage_apc = "1"</code></p>
<h1 id="additional-options"><a name="extra">Additional Options</a></h1>
<p>Here are some of the other options available when adding an alerting rule:</p>
<ul>
<li>Rule name: The name associated with the rule.</li>
<li>Severity: How "important" the rule is.</li>
<li>Max alerts: The maximum number of alerts sent for the event.  <code>-1</code> means unlimited.</li>
<li>Delay: The amount of time in seconds to wait after a rule is matched before sending an alert.</li>
<li>Interval: The interval of time in seconds between alerts for an event until Max is reached.</li>
<li>Mute alerts: Disable sending alerts for this rule.</li>
<li>Invert match: Invert the matching rule (ie. alert on items that <em>don't</em> match the rule).</li>
</ul></div>
                
            
            </div>
        </div>

        <footer>
            <div class="container">
                <hr>
                
                <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
            </div>
        </footer>

        <script src="../../js/jquery-1.12.4.min.js"></script>
        <script src="../../js/bootstrap-3.3.7.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
